<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Song Search</title>
    <link rel="stylesheet" href="../static/css/styles.css">
    <script>
        async function searchSong() {
            const query = document.getElementById('searchInput').value;
            if (query.length > 2) { // –ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–ª–∏–Ω–µ —Å—Ç—Ä–æ–∫–∏ > 2
                const response = await fetch(`/search?q=${encodeURIComponent(query)}`);
                const data = await response.json();
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                data.forEach(song => {
                    const songElement = document.createElement('div');
                    songElement.innerHTML = `<p><a href="${song.url}" target="_blank">${song.title}</a></p>`;
                    resultsDiv.appendChild(songElement);
                });
            }
        }Y

        function startVoiceInput() {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.lang = 'en-US'; // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —è–∑—ã–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
                recognition.interimResults = false;
                recognition.maxAlternatives = 1;

                recognition.start();

                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('searchInput').value = transcript;
                    searchSong(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫
                };

                recognition.onerror = function(event) {
                    console.error('Speech recognition error:', event.error);
                    alert('Voice recognition failed. Please try again.');
                };

                recognition.onend = function() {
                    console.log('Speech recognition ended.');
                };
            } else {
                alert('Your browser does not support voice recognition.');
            }
        }
    </script>
</head>
<body>
    <h1>Live Song Search</h1>
    <div style="display: flex; align-items: center; gap: 10px;">
        <input type="text" id="searchInput" oninput="searchSong()" placeholder="Type lyrics..." style="flex-grow: 1;">
        <button onclick="startVoiceInput()" style="padding: 10px; border: 1px solid #ccc; border-radius: 5px; cursor: pointer;">üé§</button>
    </div>
    <div id="results"></div>
</body>
</html>
